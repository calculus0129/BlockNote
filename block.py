#PoS verification, etc
'''
Has Different RSA Key for each different block
'''
import os
import RSA_Signature

from path import *





n = [31676752383854794769589854195828579304231624214914393413957992306742067982482522587049928127438987671892790033105815366098002296580475308743951016838387617270426754392394247210737391222025461055958428135975057543602878915586908468232709968938543879814490285144968954294924834481082462166280031545001002383141910546487553748229076090776652358284066624500207847029802920479192468652315744164515545257064675733920210767975367286624852952806544768362710126480033878138983023442041237199979436667275943393548845708049972189007053497973123660659710453502661849957442201173555195005893594123241760739194046811366050377870553]
e = [65537]
d = [5578727680767383939310711462658551083043798261875611162914127091633992228112566576128450653018917492545990548272080213551171742788529319522142951864575276233810909855455916525113004401858764842880696057882175170793054739211500336303796915658157582141673358120500353547950355365376104770178740621212468826864516577677989599866257150233061258871884873656211309116662493424327896680453275241417233609327952791670587481424933682590038429230693397266143963260674464510856755989922955688232242658730827287786241828086836615434276907371272529001015440637950284044466639499403976033764765250968351848503270597625502654009313]


def create_block(n, e, d):
    pblock = os.listdir(p[0])  # if /block is null
    if pblock == []:  # create genesis block
        pass#RSA
    else:  # else, which means if there's already a created block
        res=''
        for i in os.listdir(p[1]):
            f=open(p[1]+'/'+i)
            t=f.read()
            res=res+i+'@'+t+'|'
        num=len(pblock)
        s='@'.join(RSA_Signature.RSAsign('@'.join(res), e[0], n[0], d[0]))  # [0] is a test
        nf=open(p[0]+'block'+str(num)+'.txt','w')
        nf.write(s)
        nf.flush()
        nf.close()
def verify_block(num):  # verify block{num}.txt
    global n, e
    pblock = os.listdir(p[0])
    if pblock == []:  # if /block is null
        return None #
    else:
        res=''
        with open(p[0]+'/'+'block'+str(num)+'.txt') as f:
            t=f.read()
            f.close()
        return RSA_Signature.RSAverify(t, e[0], n[0])  # [0] is a test
create_block(n, e, d)
print(verify_block(2))
